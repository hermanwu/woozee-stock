<div class="container">
  <table mat-table [dataSource]="dataSource" matSort class="mat-elevation-z8">
    <ng-container matColumnDef="ticker">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>美股代码</th>
      <td mat-cell *matCellDef="let stock">
        <ng-container *ngIf="stock.enabled === true; else disabledLink">
          <a [routerLink]="['/stocks', stock.ticker]" class="margin-left-20">
            {{ stock.ticker }}
          </a>
        </ng-container>
        <ng-template #disabledLink>
          {{ stock.ticker }}
        </ng-template>
      </td>
    </ng-container>

    <ng-container matColumnDef="name">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>Name</th>
      <td mat-cell *matCellDef="let stock">{{ stock.name }}</td>
    </ng-container>

    <ng-container matColumnDef="chinese-name">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>中文名字</th>
      <td mat-cell *matCellDef="let stock">{{ stock.chineseName }}</td>
    </ng-container>

    <ng-container matColumnDef="lastYearQuarterRevenue">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>去年同季度收入</th>
      <td mat-cell *matCellDef="let stock">
        {{ stock.lastQuarterRevenue | unit: 2 }}
      </td>
    </ng-container>
    <ng-container matColumnDef="currentQuarterRevenue">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>最新季度收入</th>
      <td mat-cell *matCellDef="let stock">
        {{ stock.currentQuarterRevenue | unit: 2 }}
      </td>
    </ng-container>
    <ng-container matColumnDef="revenue-increase">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>收入增幅</th>
      <td mat-cell *matCellDef="let stock">
        <strong>{{
          (stock.currentQuarterRevenue - stock.lastQuarterRevenue) /
            stock.lastQuarterRevenue | percent
        }}</strong>
      </td>
    </ng-container>

    <ng-container matColumnDef="2020SecondOperatingIncome">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>
        去年同季度营业利润
      </th>
      <td mat-cell *matCellDef="let stock">
        {{ stock.lastQuarterOperatingIncome | unit: 2 }}
      </td>
    </ng-container>
    <ng-container matColumnDef="2021SecondOperatingIncome">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>
        最新季度营业利润
      </th>
      <td mat-cell *matCellDef="let stock">
        {{ stock.currentQuarterOperatingIncome | unit: 2 }}
      </td>
    </ng-container>
    <ng-container matColumnDef="operatingIncomeIncrease">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>利润增幅</th>
      <td mat-cell *matCellDef="let stock">
        <strong>{{
          (stock.currentQuarterOperatingIncome -
            stock.lastQuarterOperatingIncome) /
            (stock.lastQuarterOperatingIncome > 0
              ? stock.lastQuarterOperatingIncome
              : -stock.lastQuarterOperatingIncome) | percent
        }}</strong>
      </td>
    </ng-container>

    <ng-container matColumnDef="latestQuarterMarketCap">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>最新季度估值</th>
      <td mat-cell *matCellDef="let stock">
        {{ stock.latestQuarterMarketCap | unit: 2 }}
      </td>
    </ng-container>

    <ng-container matColumnDef="form10Q">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>10-Q</th>
      <td mat-cell *matCellDef="let stock">
        <a target="_blank" href="{{ stock.current10Q }}"> 10-Q </a>
      </td>
    </ng-container>

    <ng-container matColumnDef="website">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>Investor Site</th>
      <td mat-cell *matCellDef="let stock">
        <span *ngIf="stock.investorWebsite">
          <a target="_blank" href="{{ stock.investorWebsite }}"
            >Investor Site</a
          >
        </span>
      </td>
    </ng-container>

    <ng-container matColumnDef="pressRelease">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>Press Release</th>
      <td mat-cell *matCellDef="let stock">
        <span *ngIf="stock.currentPressRelease">
          <a target="_blank" href="{{ stock.currentPressRelease }}"
            >Press Release</a
          >
        </span>
      </td>
    </ng-container>

    <ng-container matColumnDef="presentation">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>Presentation</th>
      <td mat-cell *matCellDef="let stock">
        <span *ngIf="stock.presentation">
          <a target="_blank" href="{{ stock.presentation }}">Presentation</a>
        </span>
      </td>
    </ng-container>

    <ng-container matColumnDef="webcast">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>Webcast</th>
      <td mat-cell *matCellDef="let stock">
        <span *ngIf="stock.webcast">
          <a target="_blank" href="{{ stock.webcast }}">Webcast</a>
        </span>
      </td>
    </ng-container>

    <ng-container matColumnDef="salesOverMarketCap">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>
        Quarter Sales / Market Cap
      </th>
      <td mat-cell *matCellDef="let stock">
        <strong>{{
          stock.currentQuarterRevenue / stock.latestQuarterMarketCap
            | percent: "0.3-3"
        }}</strong>
      </td>
    </ng-container>

    <ng-container matColumnDef="sales-score">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>
        Sales increase / Market Cap
      </th>
      <td mat-cell *matCellDef="let stock">
        <strong>{{
          (stock.currentQuarterRevenue - stock.lastQuarterRevenue) /
            stock.latestQuarterMarketCap | percent: "0.3-3"
        }}</strong>
      </td>
    </ng-container>

    <ng-container matColumnDef="profitOverMarketCap">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>
        Quarter Profit / Market Cap
      </th>
      <td mat-cell *matCellDef="let stock">
        <strong>{{
          stock.currentQuarterOperatingIncome / stock.latestQuarterMarketCap
            | percent: "0.3-3"
        }}</strong>
      </td>
    </ng-container>

    <ng-container matColumnDef="profit-score">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>
        Profit increase / Market Cap
      </th>
      <td mat-cell *matCellDef="let stock">
        <strong>{{
          (stock.currentQuarterOperatingIncome -
            stock.lastQuarterOperatingIncome) /
            stock.latestQuarterMarketCap | percent: "0.3-3"
        }}</strong>
      </td>
    </ng-container>

    <ng-container matColumnDef="shares">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>持有股数</th>
      <td mat-cell *matCellDef="let stock">{{ stock.shares }}</td>
    </ng-container>

    <ng-container matColumnDef="categories">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>类别</th>
      <td mat-cell *matCellDef="let stock">{{ stock.categories }}</td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="columnsToDisplay; sticky: true"></tr>
    <tr mat-row *matRowDef="let stock; columns: columnsToDisplay"></tr>
  </table>
</div>
