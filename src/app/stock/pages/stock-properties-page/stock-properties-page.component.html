<ng-container *ngIf="stockAnalysis === null; else hasStock">
  No result is supported for now.
</ng-container>

<ng-template #hasStock>
  <app-title-menu>
    <div header-1 i18n>
      <span
        >{{ stockAnalysis.displayName || stockAnalysis.name }} ({{
          stockAnalysis?.ticker | uppercase
        }})
      </span>

      <span
        ><a
          target="_blank"
          *ngIf="stockAnalysis?.irAddress"
          title="Investor Relations"
          href="{{ stockAnalysis.irAddress }}"
        >
          ðŸ”—
        </a></span
      >

      <!-- <span *ngIf="rank$ | async; else followButton">
        - Rank {{ rank$ | async | undefined }}</span
      > -->
      <span *ngIf="stockAnalysis.price">
        - {{ stockAnalysis.price | undefined }}</span
      >
    </div>
    <div right-items>
      <button mat-icon-button [matMenuTriggerFor]="stockMenu">
        <mat-icon>more_horiz</mat-icon>
      </button>

      <mat-menu #stockMenu="matMenu">
        <button
          class="buttons"
          mat-menu-item
          aria-label="Organize widgets"
          matTooltip="Organize Widgets"
          disabled
        >
          <mat-icon>sort</mat-icon>
        </button>

        <button
          class="buttons"
          mat-menu-item
          [matMenuTriggerFor]="menu"
          aria-label="navigate to sections"
          matTooltip="Navigator"
          disabled
        >
          <mat-icon>link</mat-icon>
        </button>
        <mat-menu #menu="matMenu">
          <button mat-menu-item disabled>Business</button>
          <button mat-menu-item disabled>Growth</button>
          <button mat-menu-item disabled>Profit</button>
        </mat-menu>
      </mat-menu>
    </div>
  </app-title-menu>

  <div class="grid grid-dynamic">
    <div class="padding-1rem" *ngIf="opinions?.length > 0">
      <app-card>
        <app-title-menu>
          <div header-2>Opinions</div>

          <div right-items>
            <button
              right-items
              mat-icon-button
              [matMenuTriggerFor]="opinionMenu"
            >
              <mat-icon>more_horiz</mat-icon>
            </button>

            <mat-menu #opinionMenu="matMenu">
              <button
                mat-menu-item
                type="button"
                (click)="setDisplayMode(displayModeEnum.list)"
              >
                <mat-icon>list</mat-icon>
              </button>
              <button
                mat-menu-item
                type="button"
                (click)="setDisplayMode(displayModeEnum.slide)"
              >
                <mat-icon>view_array</mat-icon>
              </button>

              <button mat-menu-item type="button" matTooltip="Add Risk">
                <mat-icon>add_circle</mat-icon>
              </button>
            </mat-menu>
          </div>
        </app-title-menu>

        <div class="grid">
          <app-card *ngFor="let opinion of opinions" class="opinion-display">
            <div>
              <app-opinion-item-display
                [opinion]="opinion"
              ></app-opinion-item-display>
            </div>
          </app-card>
        </div>

        <div *ngIf="displayMode === displayModeEnum.slide">
          <app-carousal
            [items]="risks"
            (indexOfSelected)="updateDisplayItem($event)"
          >
            <div class="risk-slides-overview">
              <ng-container *ngFor="let risk of risks; let i = index">
                <span
                  [ngClass]="{
                    'current-risk-slide': i === carousalDisplayItemIndex
                  }"
                >
                  {{ risk.type }}
                </span>
                <span>-></span>
              </ng-container>

              <span>Conclusion</span>
            </div>

            <div *ngFor="let risk of risks; let i = index">
              <app-card *ngIf="i === carousalDisplayItemIndex">
                <app-risk [risk]="risk"></app-risk>
              </app-card>
            </div>
          </app-carousal>
        </div>
      </app-card>
    </div>

    <div class="padding-1rem" *ngIf="news?.length > 0">
      <app-card>
        <app-title-menu>
          <div header-2>Facts</div>
        </app-title-menu>

        <div *ngFor="let item of news">
          <app-news-display
            [shortVersion]="'true'"
            [news]="item"
          ></app-news-display>
        </div>
      </app-card>
    </div>

    <div class="padding-1rem" *ngIf="stockAnalysis">
      <app-fact [factType]="factType.business" [stock]="stockAnalysis">
        <app-business-overview [stock]="stockAnalysis"></app-business-overview>
      </app-fact>
    </div>
  </div>
</ng-template>
