<div class="title-display padding-1rem">
  <h1>
    {{ stockAnalysis.shortName || stockAnalysis.name }}
    ({{ stockAnalysis?.ticker | uppercase }})
  </h1>
  <button
    class="buttons"
    mat-icon-button
    type="button"
    (click)="showDetails = !showDetails"
  >
    <mat-icon *ngIf="showDetails">expand_less</mat-icon>
    <mat-icon *ngIf="!showDetails">expand_more</mat-icon>
  </button>
</div>

<div *ngIf="showDetails" class="details-panel">
  <div class="padding-1rem" *ngIf="stockAnalysis.predications">
    <app-card>
      <div>My Forecast</div>
      Price: {{ stockAnalysis.predications[0]?.price }}
    </app-card>
  </div>

  <div class="padding-1rem">
    <app-card>
      <app-links [stock]="stockAnalysis"></app-links>
    </app-card>
  </div>

  <div class="padding-1rem" *ngIf="stockAnalysis.business">
    <app-fact [factType]="factType.business">
      <app-business-overview
        [business]="stockAnalysis.business"
      ></app-business-overview>

      <app-note
        [note]="{
          content: 'More descriptions',
          notes: stockAnalysis.description
        }"
      ></app-note>
    </app-fact>
  </div>

  <div class="padding-1rem">
    <app-fact [factType]="factType.growth" [stock]="stockAnalysis">
      <app-growth [stock]="stockAnalysis"></app-growth>
    </app-fact>
  </div>

  <div class="padding-1rem">
    <app-fact [factType]="factType.profit" [stock]="stockAnalysis">
      <app-profitability [stock]="stockAnalysis"></app-profitability>
    </app-fact>
  </div>

  <div class="padding-1rem">
    <app-fact [factType]="factType.valuation" [stock]="stockAnalysis">
      <app-valuation [stock]="stockAnalysis"></app-valuation>
    </app-fact>
  </div>

  <!-- <div class="padding-1rem">
    <app-card>
      <h2>Sentiments</h2>
    </app-card>
  </div>

  <div class="padding-1rem">
    <app-card>
      <h2>Technical</h2>
    </app-card>
  </div>

  <div class="padding-1rem">
    <app-card>
      <h2>Macro</h2>
    </app-card>
  </div> -->
  <!-- <div class="logo-container">
    <div class="logo-image">
      <img
        src="{{ stockAnalysis.logo }}"
        alt="{{ stockAnalysis.name + ' Logo' }}"
      />

      <div class="video-title">
        <app-thumbnail></app-thumbnail>
      </div>
    </div>
  </div> -->

  <!-- <div class="padding-1rem">
    <div>
      <app-title-menu>
        <div title>News</div>
      </app-title-menu>
    </div>

    <ng-container *ngFor="let item of stockAnalysis.news">
      <app-note [note]="item" class="news-font"></app-note>
    </ng-container>
  </div> -->
</div>

<div class="padding-1rem padding-bottom-10rem">
  <div>
    <app-title-menu>
      <div title>
        Risks
        <button mat-icon-button (click)="openRiskInfoDialog()">
          <mat-icon> info </mat-icon>
        </button>
      </div>

      <div buttons>
        <button
          mat-icon-button
          type="button"
          (click)="setDisplayMode(displayModeEnum.list)"
        >
          <mat-icon>list</mat-icon>
        </button>
        <button
          mat-icon-button
          type="button"
          (click)="setDisplayMode(displayModeEnum.slide)"
        >
          <mat-icon>view_array</mat-icon>
        </button>
      </div>
    </app-title-menu>
  </div>

  <div class="grid grid-list" *ngIf="displayMode === displayModeEnum.list">
    <div *ngFor="let risk of stockAnalysis.risks">
      <app-card>
        <app-risk [risk]="risk"></app-risk>
      </app-card>
    </div>
  </div>

  <div *ngIf="displayMode === displayModeEnum.slide">
    <app-carousal
      [items]="stockAnalysis.risks"
      (indexOfSelected)="updateDisplayItem($event)"
    >
      <div class="risk-slides-overview">
        <ng-container *ngFor="let risk of stockAnalysis.risks; let i = index">
          <span
            [ngClass]="{
              'current-risk-slide': i === carousalDisplayItemIndex
            }"
          >
            {{ risk.type }}
          </span>
          <span>-></span>
        </ng-container>

        <span>Conclusion</span>
      </div>

      <div *ngFor="let risk of stockAnalysis.risks; let i = index">
        <app-card *ngIf="i === carousalDisplayItemIndex">
          <app-risk [risk]="risk"></app-risk>
        </app-card>
      </div>
    </app-carousal>
  </div>

  <div></div>
</div>

<!-- <mat-expansion-panel
  [expanded]="isAllCardOpen"
  (opened)="(true)"
  (closed)="(false)"
>
  <mat-expansion-panel-header>
    <mat-panel-title> 产品 Products </mat-panel-title>
    <mat-panel-description> </mat-panel-description>
  </mat-expansion-panel-header>
  <app-stock-products-list
    [products]="stockAnalysis?.products"
  ></app-stock-products-list>
</mat-expansion-panel> -->

<!-- <div class="margin-top-20">
  <mat-expansion-panel
    [expanded]="isAllCardOpen"
    (opened)="(true)"
    (closed)="(false)"
  >
    <mat-expansion-panel-header>
      <mat-panel-title> 用户 Customers </mat-panel-title>
    </mat-expansion-panel-header>
    <ul>
      <li *ngFor="let sentence of stockAnalysis?.customers">
        {{ sentence }}
      </li>
    </ul>
  </mat-expansion-panel>
</div> -->

<!-- <div class="margin-top-20">
  <mat-expansion-panel
    [expanded]="isAllCardOpen"
    (opened)="(true)"
    (closed)="(false)"
  >
    <mat-expansion-panel-header>
      <mat-panel-title> 竞争对手 Competitors </mat-panel-title>
    </mat-expansion-panel-header>
    <ul>
      <li *ngFor="let sentence of stockAnalysis?.competitor">
        {{ sentence }}
      </li>
    </ul>
  </mat-expansion-panel>
</div> -->

<!-- <div class="margin-top-20">
  <mat-expansion-panel
    [expanded]="isAllCardOpen"
    (opened)="(true)"
    (closed)="(false)"
  >
    <mat-expansion-panel-header>
      <mat-panel-title> 价值,愿景,和解决的痛点 Vision</mat-panel-title>
    </mat-expansion-panel-header>
    <ul>
      <li *ngFor="let sentence of stockAnalysis?.vision">
        {{ sentence }}
      </li>
    </ul>
  </mat-expansion-panel>
</div> -->

<!-- <div class="margin-top-20">
  <mat-expansion-panel
    [expanded]="isAllCardOpen"
    (opened)="(true)"
    (closed)="(false)"
  >
    <mat-expansion-panel-header>
      <mat-panel-title>商业模式和长期壁垒 Moat </mat-panel-title>
    </mat-expansion-panel-header>
    <ul>
      <li *ngFor="let sentence of stockAnalysis?.businessModel">
        {{ sentence }}
      </li>
    </ul>
  </mat-expansion-panel>
</div> -->

<!-- <div class="margin-top-20">
  <mat-expansion-panel
    [expanded]="isAllCardOpen"
    (opened)="(true)"
    (closed)="(false)"
  >
    <mat-expansion-panel-header>
      <mat-panel-title>与竞争者的区别和优势 Differeniator </mat-panel-title>
    </mat-expansion-panel-header>
    <ul>
      <li *ngFor="let sentence of stockAnalysis?.advantage">
        {{ sentence }}
      </li>
    </ul>
  </mat-expansion-panel>
</div> -->
<!--
<div class="margin-top-20">
  <mat-expansion-panel
    [expanded]="isAllCardOpen"
    (opened)="(true)"
    (closed)="(false)"
  >
    <mat-expansion-panel-header>
      <mat-panel-title> 风险 Risks </mat-panel-title>
    </mat-expansion-panel-header>
    <ul>
      <li *ngFor="let risk of stockAnalysis.risks">
        {{ risk.name }}
      </li>
    </ul>
  </mat-expansion-panel>
</div> -->

<!-- <div class="margin-top-20">
  <mat-expansion-panel
    [expanded]="isAllCardOpen"
    (opened)="(true)"
    (closed)="(false)"
  >
    <mat-expansion-panel-header>
      <mat-panel-title> 市值天花板 Market Cap Potential </mat-panel-title>
    </mat-expansion-panel-header>
    <div>Current: {{ stockAnalysis.predication?.marketCap[0] }}</div>
    <div>Potential: {{ stockAnalysis.predication?.marketCap[1] }}</div>
  </mat-expansion-panel>
</div> -->

<!-- <div class="margin-top-20">
  <mat-expansion-panel
    [expanded]="isAllCardOpen"
    (opened)="(true)"
    (closed)="(false)"
  >
    <mat-expansion-panel-header>
      <mat-panel-title>趋势（为什么现在是风口）Trend</mat-panel-title>
    </mat-expansion-panel-header>
    <ul>
      <li *ngFor="let sentence of stockAnalysis.trend">
        {{ sentence }}
      </li>
    </ul>
  </mat-expansion-panel>
</div> -->

<!-- <div class="margin-top-20">
  <mat-expansion-panel
    [expanded]="isAllCardOpen"
    (opened)="(true)"
    (closed)="(false)"
  >
    <mat-expansion-panel-header>
      <mat-panel-title> Final Score 我的评分</mat-panel-title>
    </mat-expansion-panel-header>
    <div class="score-line">Score: {{ stockAnalysis.score?.total }} / 100</div>
  </mat-expansion-panel>
</div> -->

<!-- <div *ngIf="stockAnalysis.companyOfficialDocs?.length">
  官方文件链接
  <ul>
    <li *ngFor="let docs of stockAnalysis.companyOfficialDocs">
      <div *ngFor="let link of docs.links">
        <a target="_blank" href="{{ link }}">{{ docs.text }}</a>
      </div>
    </li>
  </ul>
</div>

<div class="margin-top-20" *ngIf="stockAnalysis.usefulVideos?.length">
  有用的参考：（感谢以下材料的作者）
  <ul>
    <li *ngFor="let docs of stockAnalysis.usefulVideos">
      <div *ngFor="let link of docs.links">
        <a target="_blank" href="{{ link }}">{{ docs.text }}</a>
      </div>
    </li>
  </ul>
</div> -->
